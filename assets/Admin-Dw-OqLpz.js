import{u as N,o as w,r as d,e as L,b as M,g as A,j as e,B as _,i as G,d as f,L as O,M as g}from"./index-BWgvFA_m.js";import{g as C}from"./useGetErrorMessage-Cpnlb4hZ.js";const I="_row__button_11hyo_80",S="_notfound_11hyo_113",B="_modal__container__header_11hyo_120",F="_modal__container__body_11hyo_128",J="_modal__container__footer_11hyo_137",D={"admin-table":"_admin-table_11hyo_6",row__button:I,notfound:S,modal__container__header:B,modal__container__body:F,modal__container__footer:J},P=f.bind(D),Q=()=>{const{data:o,isLoading:s,isError:h,error:u}=N(void 0,{pollingInterval:6e3}),[c,{isLoading:i,isError:m,error:x}]=w(),[j,t]=d.useState(!1),[a,b]=d.useState(null),l=L(),p=M(A),y=n=>{t(!0),b(n)},k=d.useCallback(async()=>{try{if(t(!1),!a)return;await c(a)}catch(n){console.log(n)}},[c,a]),T=d.useMemo(()=>o?o.map(n=>{const v=p.find(E=>parseInt(E.id)===n.userId)?.name??"—";return e.jsxs("tr",{children:[e.jsx("td",{children:n.id}),e.jsx("td",{children:v}),e.jsx("td",{children:e.jsx(_,{type:"button",className:P("row__button"),onClick:()=>y(n.id),isDisabled:i||s||o[0].id!==n.id,children:"DELETE"})})]},n.id)}):[],[o,p,i,s]);return d.useEffect(()=>{l(G())},[l,o]),{rows:T,tags:o,isLoadingG:s,isLoadingD:i,isErrorG:h,isErrorD:m,isDModalOpen:j,setIsDModalOpen:t,handleDelete:k,errorG:u,errorD:x}},r=f.bind(D),R=()=>{const{rows:o,tags:s,isLoadingG:h,isLoadingD:u,isErrorG:c,isErrorD:i,isDModalOpen:m,setIsDModalOpen:x,handleDelete:j,errorG:t,errorD:a}=Q();return console.log(t),console.log(a),e.jsxs(e.Fragment,{children:[e.jsx("section",{className:r("admin-table"),children:e.jsxs("div",{children:[s!==void 0&&s?.length>0?e.jsxs("h1",{children:["Aktuelle Ticket: ",e.jsx("span",{children:s!==void 0&&s?.length>0?s[0].id:""})]}):"",e.jsxs("table",{children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Ticket"}),e.jsx("th",{children:"Student"}),e.jsx("th",{children:"Done"})]})}),e.jsx("tbody",{children:o})]}),s===void 0||s?.length===0?e.jsx("h1",{className:r("notfound"),children:"Noch kein Ticket vorhanden"}):""]})}),(h||u)&&e.jsx(O,{}),e.jsxs(g,{isOpen:m,children:[e.jsx("div",{className:r("modal__container__header"),children:"Ticket abschliessen"}),e.jsx("div",{className:r("modal__container__body"),children:"Bist du sicher, dass du dieses Ticket abschliessen möchtest?"}),e.jsxs("div",{className:r("modal__container__footer"),children:[e.jsx(_,{onClick:()=>x(!1),children:"Abbrechen"}),e.jsx(_,{sType:"secondary",onClick:()=>j(),children:"Ja, abschließen"})]})]}),(c||i)&&(()=>{const{status:b,message:l}=C(a||t);return e.jsxs(g,{isOpen:!0,children:[e.jsxs("div",{className:r("modal__container__header"),children:["Fehler: ",b]}),e.jsx("div",{className:r("modal__container__body"),children:l}),e.jsx("div",{className:r("modal__container__footer"),children:e.jsx(_,{onClick:()=>window.location.reload(),children:"Ok"})})]})})()]})},$=()=>e.jsx("main",{children:e.jsx(R,{})});export{$ as default};
