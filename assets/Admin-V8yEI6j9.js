import{u as E,o as w,r as d,e as L,b as M,g as A,j as e,B as _,i as G,d as b,L as O,M as p}from"./index-0Wvm-5l3.js";import{g as I}from"./useGetErrorMessage-Cpnlb4hZ.js";const C="_row__button_1i80f_79",S="_notfound_1i80f_112",B="_modal__container__header_1i80f_119",R="_modal__container__body_1i80f_127",F="_modal__container__footer_1i80f_136",J="_heading__container_1i80f_142",P="_length__span_1i80f_156",D={"admin-table":"_admin-table_1i80f_6",row__button:C,notfound:S,modal__container__header:B,modal__container__body:R,modal__container__footer:F,heading__container:J,length__span:P},Q=b.bind(D),U=()=>{const{data:r,isLoading:s,isError:h,error:m}=E(void 0,{pollingInterval:6e3}),[c,{isLoading:i,isError:u,error:x}]=w(),[j,t]=d.useState(!1),[a,g]=d.useState(null),l=L(),f=M(A),k=o=>{t(!0),g(o)},T=d.useCallback(async()=>{try{if(t(!1),!a)return;await c(a)}catch(o){console.log(o)}},[c,a]),v=d.useMemo(()=>r?r.map(o=>{const N=f.find(y=>parseInt(y.id)===o.userId)?.name??"—";return e.jsxs("tr",{children:[e.jsx("td",{children:o.id}),e.jsx("td",{children:N}),e.jsx("td",{children:e.jsx(_,{type:"button",className:Q("row__button"),onClick:()=>k(o.id),isDisabled:i||s||r[0].id!==o.id,children:"DELETE"})})]},o.id)}):[],[r,f,i,s]).slice(0,15);return d.useEffect(()=>{l(G())},[l,r]),{slicedRows:v,tags:r,isLoadingG:s,isLoadingD:i,isErrorG:h,isErrorD:u,isDModalOpen:j,setIsDModalOpen:t,handleDelete:T,errorG:m,errorD:x}},n=b.bind(D),W=()=>{const{slicedRows:r,tags:s,isLoadingG:h,isLoadingD:m,isErrorG:c,isErrorD:i,isDModalOpen:u,setIsDModalOpen:x,handleDelete:j,errorG:t,errorD:a}=U();return console.log(t),console.log(a),e.jsxs(e.Fragment,{children:[e.jsx("section",{className:n("admin-table"),children:e.jsxs("div",{children:[s!==void 0&&s?.length>0?e.jsxs("div",{className:n("heading__container"),children:[e.jsxs("h1",{children:["Aktuelle Ticket: ",e.jsx("span",{children:s!==void 0&&s?.length>0?s[0].id:""})]}),e.jsxs("p",{children:["Insgesamt:",e.jsx("span",{className:n("length__span"),children:s.length})]})]}):"",e.jsxs("table",{children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Ticket"}),e.jsx("th",{children:"Student"}),e.jsx("th",{children:"Done"})]})}),e.jsx("tbody",{children:r})]}),s===void 0||s?.length===0?e.jsx("h1",{className:n("notfound"),children:"Noch kein Ticket vorhanden"}):""]})}),(h||m)&&e.jsx(O,{}),e.jsxs(p,{isOpen:u,children:[e.jsx("div",{className:n("modal__container__header"),children:"Ticket abschliessen"}),e.jsx("div",{className:n("modal__container__body"),children:"Bist du sicher, dass du dieses Ticket abschliessen möchtest?"}),e.jsxs("div",{className:n("modal__container__footer"),children:[e.jsx(_,{onClick:()=>x(!1),children:"Abbrechen"}),e.jsx(_,{sType:"secondary",onClick:()=>j(),children:"Ja, abschließen"})]})]}),(c||i)&&(()=>{const{status:g,message:l}=I(a||t);return e.jsxs(p,{isOpen:!0,children:[e.jsxs("div",{className:n("modal__container__header"),children:["Fehler: ",g]}),e.jsx("div",{className:n("modal__container__body"),children:l}),e.jsx("div",{className:n("modal__container__footer"),children:e.jsx(_,{onClick:()=>window.location.reload(),children:"Ok"})})]})})()]})},H=()=>e.jsx("main",{children:e.jsx(W,{})});export{H as default};
